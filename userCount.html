<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live User Count</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.28.2/dist/umd/supabase.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #userCount {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="userCount">Users Online: 0</div>

    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://qrtikodjxlzohmkaazbi.supabase.co'; // Your Supabase URL
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFydGlrb2RqeGx6b2hta2FhemJpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYyNzI4OTMsImV4cCI6MjA1MTg0ODg5M30.pVGWL3QQouej8HU9l2ANOcLolcktan5XhzuKGTRkad0'; // Your anon key
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        // Function to fetch the current user count
        async function fetchUserCount() {
            const { data, error } = await supabase
                .from('user_count')
                .select('count')
                .eq('id', 1) // Assuming the row ID where count is stored is 1
                .single();

            if (error) {
                console.error("Error fetching user count:", error);
            } else {
                document.getElementById('userCount').innerText = `Users Online: ${data.count}`;
            }
        }

        // Real-time subscription to listen for changes to the user_count table
        supabase
            .from('user_count')
            .on('UPDATE', payload => {
                fetchUserCount();
            })
            .subscribe();

        // Initial fetch of user count when the page loads
        fetchUserCount();
    </script>
  
</body>
  <div id="userCount" style="position: absolute; top: 10px; right: 10px; color: black; font-size: 18px;">
    Users Online: 0
</div>

</html>
